{% extends "demo_app/base.html" %}
{% block title %}{{ author.username }} · DDBlog{% endblock %}

{% block content %}
<div class="row g-4">
  <div class="col-lg-8">

    <!-- Author header -->
    <div class="card border-0 shadow-sm mb-4" style="border-radius:14px">
      <div class="card-body p-4 p-md-5">
        <div class="d-flex align-items-start gap-4 flex-wrap">
          <div class="avatar avatar-lg flex-shrink-0">{{ author.username|first|upper }}</div>
          <div class="flex-grow-1">
            <h2 class="fw-800 mb-1" style="font-weight:800">{{ author.username }}</h2>
            {% if author.email %}
            <p class="text-muted small mb-1"><i class="bi bi-envelope me-1"></i>{{ author.email }}</p>
            {% endif %}
            {% if author.bio %}
            <p class="mb-3">{{ author.bio }}</p>
            {% endif %}

            {% if profile %}
            <div class="d-flex flex-wrap gap-3 mt-2">
              {% if profile.location %}
              <span class="text-muted small"><i class="bi bi-geo-alt me-1"></i>{{ profile.location }}</span>
              {% endif %}
              {% if profile.twitter %}
              <span class="text-muted small"><i class="bi bi-twitter-x me-1"></i>{{ profile.twitter }}</span>
              {% endif %}
              {% if profile.website %}
              <a href="{{ profile.website }}" target="_blank" rel="noopener" class="small text-decoration-none">
                <i class="bi bi-globe me-1"></i>{{ profile.website }}
              </a>
              {% endif %}
              {% if profile.follower_count %}
              <span class="text-muted small">
                <i class="bi bi-people me-1"></i>{{ profile.follower_count }} follower{{ profile.follower_count|pluralize }}
              </span>
              {% endif %}
            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <!-- Posts -->
    <h5 class="fw-bold mb-3">
      <i class="bi bi-file-earmark-text me-2"></i>
      {{ posts|length }} post{{ posts|length|pluralize }}
    </h5>

    {% for post in posts %}
    <div class="card post-card border-0 shadow-sm mb-3">
      <div class="card-body p-4">
        <div class="d-flex flex-wrap gap-2 mb-1">
          {% for label in post.label_list %}
          <a href="{% url 'tag-detail-fe' slug=label.slug %}" class="tag-pill"
             style="background:{{ label.colour }}22; color:{{ label.colour }}; border-color:{{ label.colour }}44">
            {{ label.name }}
          </a>
          {% endfor %}
        </div>
        <h5 class="card-title mb-1">
          <a href="{% url 'post-detail' pk=post.pk %}">{{ post.title }}</a>
        </h5>
        <p class="post-meta mb-2">
          <i class="bi bi-calendar3 me-1"></i>{{ post.created_at|date:"M j, Y" }}
          · <i class="bi bi-eye me-1"></i>{{ post.view_count }} view{{ post.view_count|pluralize }}
        </p>
        {% if post.body %}
        <p class="text-muted small mb-2">{{ post.body|truncatechars:180 }}</p>
        {% endif %}
        <a href="{% url 'post-detail' pk=post.pk %}" class="btn btn-sm btn-outline-primary">
          Read more <i class="bi bi-arrow-right"></i>
        </a>
      </div>
    </div>
    {% empty %}
    <p class="text-muted">No published posts yet.</p>
    {% endfor %}

  </div>

  <!-- Sidebar -->
  <div class="col-lg-4">
    <div class="card border-0 shadow-sm" style="border-radius:12px; background:var(--accent-soft)">
      <div class="card-body p-4 text-center">
        <i class="bi bi-pencil-square" style="font-size:1.6rem; color:var(--accent)"></i>
        <p class="mt-2 mb-3 small">Write your own post</p>
        <a href="{% url 'write-post' %}" class="btn btn-sm w-100"
           style="background:var(--accent);color:#fff;border-radius:8px">Write a post</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}
